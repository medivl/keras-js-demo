webpackJsonp([1],{NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),s=n("d7EF"),r=n.n(s);function i(){for(var e=0,t=0;t<arguments.length;t++)e+=arguments[t]||0;return e/arguments.length}var a={name:"app",data:function(){return{result:""}},created:function(){this.model=new window.KerasJS.Model({filepath:"/keras-js-demo/static/mnist_cnn.bin",gpu:!0,transferLayerOutputs:!0}),this.model.ready().then(function(){return console.log("keras init")})},methods:{onMouseDown:function(e){this.drawLine(e.offsetX,e.offsetY),this.listenMouseMove=!0},onMouseMove:function(e){this.listenMouseMove&&this.drawLine(e.offsetX,e.offsetY)},drawEnd:function(){this.listenMouseMove&&(this.listenMouseMove=!1,delete this.previousX,delete this.previousY,this.predict())},drawLine:function(e,t){var n=this.$refs.canvas.getContext("2d");n.lineWidth=20,n.lineJoin=n.lineCap="round",n.strokeStyle="#393E46",n.beginPath();var o=this.previousX,s=this.previousY;void 0!==o?n.moveTo(o,s):n.moveTo(e,t),n.lineTo(e,t),n.stroke(),this.previousX=e,this.previousY=t},predict:function(){var e=this,t=function(e){for(var t=[],n=0;n<e.length;n+=4){var o=e.slice(n,n+3),s=r()(o,3),a=s[0],u=s[1],c=s[2];t.push((299*a+587*u+114*c)/1e3)}for(var l=[],v=0;v<28;v++)for(var d=0;d<28;d++){for(var f=[],p=10*d;p<10*(d+1);p++)for(var h=10*v;h<10*(v+1);h++)f.push(t[p+280*h]);l.push(i.apply(void 0,f))}return l}(this.$refs.canvas.getContext("2d").getImageData(0,0,280,280).data),n={input:new Float32Array(t)};this.model.predict(n).then(function(t){var n=t.output.reduce(function(e,t){return Math.max(e,t)},0);console.log(t.output.indexOf(n)),e.result=t.output.indexOf(n)})},clear:function(){this.$refs.canvas.getContext("2d").clearRect(0,0,280,280),this.result=""}}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("canvas",{ref:"canvas",attrs:{width:"280",height:"280"},on:{mousedown:e.onMouseDown,mousemove:e.onMouseMove,mouseup:e.drawEnd,mouseleave:e.drawEnd}}),e._v(" "),n("div",{staticClass:"clear",on:{click:e.clear}},[e._v("clear")]),e._v(" "),n("p",{staticClass:"result"},[e._v("识别结果："+e._s(e.result))])])},staticRenderFns:[]};var c=n("VU/8")(a,u,!1,function(e){n("vnUr")},null,null).exports;o.a.config.productionTip=!1,new o.a({el:"#app",template:"<App/>",components:{App:c}})},vnUr:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.37a57b123bb48b681621.js.map