webpackJsonp([1],{"6pir":function(e,t){},NHnr:function(e,t,n){"use strict";function o(){for(var e=0,t=0;t<arguments.length;t++)e+=arguments[t]||0;return e/arguments.length}function s(e){for(var t=[],n=0;n<e.length;n+=4){var s=e.slice(n,n+3),i=a()(s,3),r=i[0],u=i[1],c=i[2];t.push((299*r+587*u+114*c)/1e3)}for(var l=[],d=0;d<28;d++)for(var p=0;p<28;p++){for(var f=[],v=10*p;v<10*(p+1);v++)for(var h=10*d;h<10*(d+1);h++)f.push(function(e,n){return t[e+280*n]}(v,h));l.push(o.apply(void 0,f))}return l}Object.defineProperty(t,"__esModule",{value:!0});var i=n("7+uW"),r=n("d7EF"),a=n.n(r),u={name:"app",data:function(){return{result:""}},created:function(){this.model=new window.KerasJS.Model({filepath:"/static/mnist_cnn.bin",gpu:!0,transferLayerOutputs:!0}),this.model.ready().then(function(){return console.log("keras init")})},methods:{onMouseDown:function(e){this.drawLine(e.offsetX,e.offsetY),this.listenMouseMove=!0},onMouseMove:function(e){this.listenMouseMove&&this.drawLine(e.offsetX,e.offsetY)},drawEnd:function(){this.listenMouseMove&&(this.listenMouseMove=!1,delete this.previousX,delete this.previousY,this.predict())},drawLine:function(e,t){var n=this.$refs.canvas.getContext("2d");n.lineWidth=20,n.lineJoin=n.lineCap="round",n.strokeStyle="#393E46",n.beginPath();var o=this.previousX,s=this.previousY;void 0!==o?n.moveTo(o,s):n.moveTo(e,t),n.lineTo(e,t),n.stroke(),this.previousX=e,this.previousY=t},predict:function(){var e=this,t=s(this.$refs.canvas.getContext("2d").getImageData(0,0,280,280).data),n={input:new Float32Array(t)};this.model.predict(n).then(function(t){var n=t.output.reduce(function(e,t){return Math.max(e,t)},0);console.log(t.output.indexOf(n)),e.result=t.output.indexOf(n)})},clear:function(){this.$refs.canvas.getContext("2d").clearRect(0,0,280,280),this.result=""}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("canvas",{ref:"canvas",attrs:{width:"280",height:"280"},on:{mousedown:e.onMouseDown,mousemove:e.onMouseMove,mouseup:e.drawEnd,mouseleave:e.drawEnd}}),e._v(" "),n("div",{staticClass:"clear",on:{click:e.clear}},[e._v("clear")]),e._v(" "),n("p",{staticClass:"result"},[e._v("识别结果："+e._s(e.result))])])},staticRenderFns:[]},l=n("VU/8")(u,c,!1,function(e){n("6pir")},null,null).exports;i.a.config.productionTip=!1,new i.a({el:"#app",template:"<App/>",components:{App:l}})}},["NHnr"]);
//# sourceMappingURL=app.a3bc6f9a0eac13c6fb0f.js.map